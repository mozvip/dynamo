<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:p="http://xmlns.jcp.org/jsf/passthrough">

<ui:fragment rendered="#{!category.disabled}">
	<div class="panel-group" id="#{category.id}" role="tablist" aria-multiselectable="true">
		<h:inputText class="stateInput" style="display: none;" value="#{category.expanded}" converter="javax.faces.Boolean"/>
		<div class="panel panel-default">
			<div class="panel-heading" role="tab" id="heading_#{category.id}">
				<h4 class="panel-title">
					<a data-toggle="collapse" data-parent="##{category.id}" href="#collapse_#{category.id}" aria-expanded="#{category.expanded}" aria-controls="collapse_#{category.id}"> #{category.name} </a>
				</h4>
			</div>
			<div id="collapse_#{category.id}" class="panel-collapse collapse"
				role="tabpanel" aria-labelledby="heading_#{category.id}">
				<div class="panel-body">
					<ui:repeat var="configurationItem" value="#{category.items}"
						varStatus="itemStatus">
						<ui:fragment rendered="#{!configurationItem.disabled}">
							<div
								class="form-group #{configurationItem.hasError() ? 'has-error' : ''}">
								<ui:fragment
									rendered="#{configurationItem.getClass().simpleName=='BooleanConfigurationItem'}">
									<div class="col-sm-12">
										<div class="checkbox">
											<label> <h:selectBooleanCheckbox
													value="#{configurationItem.value}"
													label="#{configurationItem.label}">
													<f:ajax execute="@form" render="@form :messages" />
												</h:selectBooleanCheckbox> <h:outputLabel value="#{configurationItem.label}"
													style="#{configurationItem.bold ? 'font-weight: bold' : ''}" />
											</label>
										</div>
									</div>
								</ui:fragment>
								<ui:fragment
									rendered="#{configurationItem.getClass().simpleName=='SelectManyConfigurationItem'}">
									<h:outputLabel styleClass="col-sm-2 control-label"
										value="#{configurationItem.label}" />
									<div class="col-sm-10">
										<h:selectManyListbox value="#{configurationItem.value}"
											label="#{configurationItem.label}" styleClass="form-control">
											<f:selectItems value="#{configurationItem.allowedValues}"
												var="item" itemLabel="#{item.label}" itemValue="#{item}" />
										</h:selectManyListbox>
									</div>
								</ui:fragment>
								<ui:fragment
									rendered="#{configurationItem.getClass().simpleName=='SelectOneConfigurationItem'}">
									<h:outputLabel styleClass="col-sm-2 control-label"
										value="#{configurationItem.label}" />
									<div class="col-sm-10">
										<h:selectOneMenu value="#{configurationItem.value}"
											label="#{configurationItem.label}" styleClass="form-control">
											<f:selectItem itemLabel="#{configurationItem.defaultLabel}"
												itemValue="" />
											<f:selectItems value="#{configurationItem.allowedValues}"
												var="val" itemLabel="#{val.label}" itemValue="#{val}" />
										</h:selectOneMenu>
									</div>
								</ui:fragment>
								<ui:fragment
									rendered="#{configurationItem.getClass().simpleName=='TextConfigurationItem'}">
									<h:outputLabel styleClass="col-sm-2 control-label"
										value="#{configurationItem.label}" />
									<div class="col-sm-10">
										<h:inputText label="#{configurationItem.label}"
											value="#{configurationItem.value}" styleClass="form-control" />
									</div>
								</ui:fragment>
								<ui:fragment
									rendered="#{configurationItem.getClass().simpleName=='IntegerConfigurationItem'}">
									<h:outputLabel styleClass="col-sm-2 control-label"
										value="#{configurationItem.label}" />
									<div
										class="col-sm-10 #{configurationItem.hasError() ? 'has-error' : ''}">
										<h:inputText label="#{configurationItem.label}"
											p:type="number" value="#{configurationItem.value}"
											styleClass="form-control" converter="javax.faces.Integer">
										</h:inputText>
									</div>
								</ui:fragment>
								<ui:fragment
									rendered="#{configurationItem.getClass().simpleName=='FloatConfigurationItem'}">
									<h:outputLabel styleClass="col-sm-2 control-label"
										value="#{configurationItem.label}" />
									<div
										class="col-sm-10 #{configurationItem.hasError() ? 'has-error' : ''}">
										<h:inputText label="#{configurationItem.label}"
											p:type="number" value="#{configurationItem.value}"
											styleClass="form-control" converter="javax.faces.Float" />
									</div>
								</ui:fragment>
								<ui:fragment
									rendered="#{configurationItem.getClass().simpleName=='PathConfigurationItem'}">
									<h:outputLabel styleClass="col-sm-2 control-label"
										value="#{configurationItem.label}" />
									<div
										class="col-sm-10 input-group #{configurationItem.hasError() ? 'has-error' : ''}">
										<span class="input-group-addon"><i
											class="fa fa-folder-open-o" /></span>
										<ui:fragment rendered="#{configurationItem.folder}">
											<h:inputText label="#{configurationItem.label}"
												value="#{configurationItem.value}" converter="PathConverter"
												styleClass="form-control">
												<f:ajax execute="@form" render="@form :messages" />
												<f:passThroughAttribute name="placeholder"
													value="Enter Folder..." />
											</h:inputText>
											<span class="input-group-btn"> <a href="#"
												class="btn btn-default"
												onclick="window.browserTargetField = $(this).parent().prev();"
												data-toggle="modal" data-target="#browseFolder"> <span
													class="fa fa-search" /></a>
											</span>
										</ui:fragment>
										<ui:fragment rendered="#{!configurationItem.folder}">
											<h:inputText label="#{configurationItem.label}"
												value="#{configurationItem.value}" converter="PathConverter"
												styleClass="form-control">
												<f:ajax execute="@form" render="@form :messages" />
												<f:passThroughAttribute name="placeholder"
													value="Enter path to file..." />
											</h:inputText>
											<span class="input-group-btn"> <a href="#"
												class="btn btn-default"
												onclick="window.browserTargetField = $(this).parent().prev();"
												data-toggle="modal" data-target="#browseFile"> <span
													class="fa fa-search" />
											</a>
											</span>
										</ui:fragment>
									</div>
								</ui:fragment>

								<h:dataTable var="row"
									styleClass="table #{configurationItem.hasError() ? 'has-error' : ''}"
									value="#{configurationItem.list}"
									id="providerListConfigurationItem"
									rendered="#{configurationItem.getClass().simpleName=='ImplementationListConfigurationItem'}">
									<f:facet name="header">
										#{configurationItem.label}
									</f:facet>
									<h:column>
										<h:commandLink styleClass="btn btn-danger btn-default"
											actionListener="#{configuration.removeItem}">
											<i class="fa fa-trash-o"></i>
											<f:param name="key" value="#{configurationItem.key}" />
											<f:param name="index" value="#{row.index}" />
											<f:ajax execute="providerListConfigurationItem"
												onevent="removeParentRow" />
										</h:commandLink>
									</h:column>
									<h:column>
										<h:outputText value="#{row.value}" />
									</h:column>
									<h:column rendered="#{configurationItem.orderable}">
										<h:commandLink styleClass="btn btn-default" rendered="#{row.index gt 0}" action="#{configurationItem.moveUp(row.index)}">
											<f:ajax execute="@form" render="@form" />
											<i class="fa fa-arrow-up" />
										</h:commandLink>
									</h:column>
									<h:column rendered="#{configurationItem.orderable}">
										<h:commandLink styleClass="btn btn-default"
											rendered="#{row.index lt configurationItem.value.size() - 1}"
											action="#{configurationItem.moveDown(row.index)}">
											<f:ajax execute="@form" render="@form" />
											<i class="fa fa-arrow-down" />
										</h:commandLink>
									</h:column>
									<f:facet name="footer">
										<ui:fragment
											rendered="#{configurationItem.remainingProviders.size() > 0}">
											<div class="input-group">
												<h:selectOneMenu styleClass="form-control"
													value="#{configurationItem.newProvider}"
													converter="DynamoInstanceConverter">
													<f:selectItems
														value="#{configurationItem.remainingProviders}"
														var="provider" itemLabel="#{provider}"
														itemValue="#{provider.getClass().getName()}">
													</f:selectItems>
												</h:selectOneMenu>
												<span class="input-group-btn"> <h:commandLink
														styleClass="btn btn-default"
														action="#{configuration.addProvider(configurationItem)}">
														<i class="fa fa-plus" />&nbsp;Add
												<f:ajax execute="providerListConfigurationItem"
															render="providerListConfigurationItem" />
													</h:commandLink>
												</span>
											</div>
										</ui:fragment>
									</f:facet>
								</h:dataTable>

								<h:dataTable var="row"
									styleClass="table #{configurationItem.hasError() ? 'has-error' : ''}"
									value="#{configurationItem.list}" id="listConfigurationItem"
									rendered="#{configurationItem.getClass().simpleName=='ListConfigurationItem'}">
									<f:facet name="header">
										#{configurationItem.label}
									</f:facet>
									<h:column>
										<h:commandLink styleClass="btn btn-danger btn-default"
											actionListener="#{configuration.removeItem}">
											<i class="fa fa-trash-o"></i>
											<f:param name="key" value="#{configurationItem.key}" />
											<f:param name="index" value="#{row.index}" />
											<f:ajax execute="listConfigurationItem"
												render="listConfigurationItem" />
										</h:commandLink>
									</h:column>
									<h:column>
										<ui:fragment
											rendered="#{configurationItem.contentsClass.simpleName == 'Path'}">
											<div class="input-group">
												<span class="input-group-addon"><i
													class="fa fa-folder-open-o" /></span>
												<h:inputText value="#{row.value}"
													label="#{configurationItem.label}"
													styleClass="form-control" style="width:100%"
													converter="PathConverter">
													<f:passThroughAttribute name="placeholder"
														value="Enter Folder..." />
												</h:inputText>
												<span class="input-group-btn"> <h:commandLink
														styleClass="btn btn-default"
														onclick="window.browserTargetField = $(this).parent().prev(); $('.currentFolder').val( $(window.browserTargetField).val() ); $('.selectFolderButton').click(); return false;"
														p:data-toggle="modal" p:data-target="#browseFolder">
														<span class="fa fa-search" />
													</h:commandLink>
												</span>
											</div>
										</ui:fragment>
										<ui:fragment
											rendered="#{configurationItem.contentsClass.simpleName != 'Path'}">
											<h:inputText value="#{row.value}"
												label="#{configurationItem.label}" styleClass="form-control"
												style="width:100%">
											</h:inputText>
										</ui:fragment>
									</h:column>
									<h:column rendered="#{configurationItem.orderable}">
										<h:commandLink styleClass="btn btn-default"
											rendered="#{row.index gt 0}"
											action="#{configurationItem.moveUp(row.index)}">
											<f:ajax execute="@this" />
											<i class="fa fa-arrow-up" />
										</h:commandLink>
									</h:column>
									<h:column rendered="#{configurationItem.orderable}">
										<h:commandLink styleClass="btn btn-default"
											rendered="#{row.index lt configurationItem.value.size() - 1}"
											action="#{configurationItem.moveDown(row.index)}">
											<f:ajax execute="@this" />
											<i class="fa fa-arrow-down" />
										</h:commandLink>
									</h:column>
									<f:facet name="footer">
										<h:commandLink styleClass="btn btn-default"
											action="#{configuration.addItem(configurationItem.key)}">
											<i class="fa fa-plus" />&nbsp;Add
									<f:ajax execute="listConfigurationItem"
												render="listConfigurationItem" />
										</h:commandLink>
									</f:facet>
								</h:dataTable>
							</div>
						</ui:fragment>
					</ui:repeat>

				</div>
			</div>
		</div>
	</div>
</ui:fragment>
</html>
